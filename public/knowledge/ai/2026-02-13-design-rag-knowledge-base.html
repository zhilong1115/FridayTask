<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2026-02-13 - è®¾è®¡ä¼ä¸š RAG çŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿ</title>
  <style>
    body { font-family: -apple-system, system-ui, sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; color: #3c4043; line-height: 1.7; }
    .bilingual { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 15px 0; }
    .zh { border-left: 3px solid #f9ab00; padding-left: 15px; }
    .en { border-left: 3px solid #1a73e8; padding-left: 15px; }
    h1 { color: #3c4043; border-bottom: 2px solid #f9ab00; padding-bottom: 10px; }
    h2 { color: #1a73e8; margin-top: 35px; }
    h3 { color: #5f6368; }
    .architecture { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0; }
    pre { background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 13px; }
    .highlight { background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; }
    .highlight-blue { background: #e8f0fe; padding: 15px; border-radius: 8px; margin: 15px 0; }
    .diagram { text-align: center; margin: 20px 0; font-family: monospace; white-space: pre; background: #f8f9fa; padding: 20px; border-radius: 8px; font-size: 12px; line-height: 1.4; text-align: left; }
    .follow-up { margin-top: 30px; padding: 15px; border: 1px dashed #dadce0; border-radius: 8px; }
    .tag { display: inline-block; background: #e8f0fe; color: #1a73e8; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin: 2px; }
    .series-nav { background: #f0f0f0; padding: 12px; border-radius: 8px; margin: 15px 0; font-size: 14px; }
    table { width: 100%; border-collapse: collapse; margin: 15px 0; }
    th, td { border: 1px solid #dadce0; padding: 8px 12px; text-align: left; }
    th { background: #f8f9fa; }
    .interview-q { background: #fce8e6; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #ea4335; }
    .interview-a { background: #e6f4ea; padding: 15px; border-radius: 8px; margin: 0 0 20px 0; border-left: 4px solid #34a853; }
    @media (max-width: 768px) { .bilingual { grid-template-columns: 1fr; } }
  </style>
</head>
<body>

<h1>ğŸ“š è®¾è®¡ä¼ä¸š RAG çŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿ</h1>
<p>
  <span class="tag">AI System Design</span>
  <span class="tag">RAG</span>
  <span class="tag">é¢è¯•é«˜é¢‘</span>
  <span class="tag">Phase 2.1 Day 4</span>
</p>

<div class="series-nav">
  ğŸ“– <strong>AI System Design é¢è¯•ç³»åˆ—</strong>ï¼š
  <a href="2026-02-10-design-chatgpt-system.html">Day 1 ChatGPT</a> â†’
  <a href="2026-02-11-design-recommendation-system.html">Day 2 æ¨èç³»ç»Ÿ</a> â†’
  <a href="2026-02-12-design-semantic-search-engine.html">Day 3 è¯­ä¹‰æœç´¢</a> â†’
  <strong>Day 4 RAG çŸ¥è¯†åº“ (æœ¬ç¯‡)</strong> â†’
  Day 5 AI Code Review
</div>

<h2>ğŸ“– é¢˜ç›® / Problem Statement</h2>
<div class="bilingual">
  <div class="zh">
    <p><strong>"è®¾è®¡ä¸€ä¸ªä¼ä¸šçº§ RAG çŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿ"</strong></p>
    <p>æ”¯æŒå¤šæ ¼å¼æ–‡æ¡£ï¼ˆPDFã€Wordã€PPTã€ç½‘é¡µï¼‰å¯¼å…¥ï¼Œå‘˜å·¥å¯ä»¥ç”¨è‡ªç„¶è¯­è¨€æé—®ï¼Œç³»ç»Ÿä»ä¼ä¸šçŸ¥è¯†åº“ä¸­æ£€ç´¢å¹¶ç”Ÿæˆå‡†ç¡®ç­”æ¡ˆã€‚éœ€è¦å¤„ç†æƒé™æ§åˆ¶ã€å¤šç§Ÿæˆ·ã€ç­”æ¡ˆæº¯æºã€‚</p>
    <p>å…¸å‹åœºæ™¯ï¼šå†…éƒ¨ Wiki QAã€å®¢æœçŸ¥è¯†åº“ã€æ³•å¾‹/åˆè§„æ–‡æ¡£æŸ¥è¯¢ã€‚</p>
  </div>
  <div class="en">
    <p><strong>"Design an enterprise RAG knowledge base QA system"</strong></p>
    <p>Support multi-format document ingestion (PDF, Word, PPT, web pages). Employees ask questions in natural language; the system retrieves from enterprise knowledge and generates accurate answers. Must handle access control, multi-tenancy, and answer attribution.</p>
    <p>Scenarios: Internal Wiki QA, customer support KB, legal/compliance doc search.</p>
  </div>
</div>

<h2>ğŸ¯ éœ€æ±‚åˆ†æ / Requirements</h2>

<h3>Functional Requirements</h3>
<div class="bilingual">
  <div class="zh">
    <ol>
      <li><strong>æ–‡æ¡£å¯¼å…¥</strong>ï¼šPDFã€Wordã€PPTã€HTMLã€Confluenceã€Notion</li>
      <li><strong>è‡ªç„¶è¯­è¨€é—®ç­”</strong>ï¼šç”¨æˆ·æé—® â†’ æ£€ç´¢ â†’ ç”Ÿæˆç­”æ¡ˆ</li>
      <li><strong>ç­”æ¡ˆæº¯æº</strong>ï¼šæ¯ä¸ªç­”æ¡ˆæ ‡æ³¨æ¥æºæ–‡æ¡£ + é¡µç /æ®µè½</li>
      <li><strong>æƒé™æ§åˆ¶</strong>ï¼šä¸åŒéƒ¨é—¨åªèƒ½æŸ¥çœ‹æˆæƒæ–‡æ¡£</li>
      <li><strong>å¢é‡æ›´æ–°</strong>ï¼šæ–‡æ¡£æ›´æ–°åè‡ªåŠ¨é‡æ–°ç´¢å¼•</li>
      <li><strong>å¤šè½®å¯¹è¯</strong>ï¼šæ”¯æŒè¿½é—®å’Œä¸Šä¸‹æ–‡ç†è§£</li>
    </ol>
  </div>
  <div class="en">
    <ol>
      <li><strong>Document Ingestion</strong>: PDF, Word, PPT, HTML, Confluence, Notion</li>
      <li><strong>Natural Language QA</strong>: Query â†’ Retrieve â†’ Generate answer</li>
      <li><strong>Answer Attribution</strong>: Source document + page/section for every answer</li>
      <li><strong>Access Control</strong>: Department-level document permissions</li>
      <li><strong>Incremental Update</strong>: Auto re-index on document changes</li>
      <li><strong>Multi-turn Dialogue</strong>: Follow-up questions with context</li>
    </ol>
  </div>
</div>

<h3>Non-Functional Requirements</h3>
<table>
  <tr><th>æŒ‡æ ‡</th><th>ç›®æ ‡</th><th>è¯´æ˜</th></tr>
  <tr><td>Latency (P95)</td><td>&lt; 3s (é¦– token), &lt; 10s (å®Œæ•´å›ç­”)</td><td>æµå¼è¾“å‡º SSE</td></tr>
  <tr><td>Accuracy</td><td>&gt; 85% Faithfulness</td><td>RAGAS æŒ‡æ ‡</td></tr>
  <tr><td>Document Scale</td><td>100K-1M æ–‡æ¡£</td><td>ä¸­å¤§å‹ä¼ä¸š</td></tr>
  <tr><td>Concurrent Users</td><td>1000 QPS</td><td>å…¨å…¬å¸ä½¿ç”¨</td></tr>
  <tr><td>Freshness</td><td>&lt; 5 min</td><td>æ–‡æ¡£æ›´æ–°åˆ°å¯æ£€ç´¢</td></tr>
</table>

<h2>ğŸ—ï¸ æ•´ä½“æ¶æ„ / High-Level Architecture</h2>

<div class="diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Enterprise RAG System                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          â”‚                                          â”‚
â”‚  â”Œâ”€ OFFLINE PIPELINE â”€â”  â”‚  â”Œâ”€â”€â”€ ONLINE PIPELINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     â”‚  â”‚  â”‚                                   â”‚   â”‚
â”‚  â”‚  Data Sources       â”‚  â”‚  â”‚  User Query                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚    â”‚                              â”‚   â”‚
â”‚  â”‚  â”‚ PDF/Word/PPT â”‚   â”‚  â”‚  â”‚    â–¼                              â”‚   â”‚
â”‚  â”‚  â”‚ Confluence   â”‚   â”‚  â”‚  â”‚  Query Understanding              â”‚   â”‚
â”‚  â”‚  â”‚ Notion/Wiki  â”‚   â”‚  â”‚  â”‚  â”œâ”€ Intent Classification        â”‚   â”‚
â”‚  â”‚  â”‚ Slack/Email  â”‚   â”‚  â”‚  â”‚  â”œâ”€ Query Rewrite                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚  â””â”€ History Fusion               â”‚   â”‚
â”‚  â”‚         â”‚           â”‚  â”‚  â”‚    â”‚                              â”‚   â”‚
â”‚  â”‚         â–¼           â”‚  â”‚  â”‚    â–¼                              â”‚   â”‚
â”‚  â”‚  Document Parser    â”‚  â”‚  â”‚  Access Control Filter            â”‚   â”‚
â”‚  â”‚  â”œâ”€ Format detect   â”‚  â”‚  â”‚  (pre-filter by user ACL)        â”‚   â”‚
â”‚  â”‚  â”œâ”€ OCR (images)    â”‚  â”‚  â”‚    â”‚                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ Table extract   â”‚  â”‚  â”‚    â–¼                              â”‚   â”‚
â”‚  â”‚  â””â”€ Layout parse    â”‚  â”‚  â”‚  Hybrid Retrieval                â”‚   â”‚
â”‚  â”‚         â”‚           â”‚  â”‚  â”‚  â”œâ”€ Vector Search (ANN)          â”‚   â”‚
â”‚  â”‚         â–¼           â”‚  â”‚  â”‚  â”œâ”€ BM25 Keyword                 â”‚   â”‚
â”‚  â”‚  Chunking Engine    â”‚  â”‚  â”‚  â””â”€ RRF Fusion                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ Semantic split  â”‚  â”‚  â”‚    â”‚                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ Parent-Child    â”‚  â”‚  â”‚    â–¼                              â”‚   â”‚
â”‚  â”‚  â””â”€ Metadata tag    â”‚  â”‚  â”‚  Reranker (Cross-Encoder)        â”‚   â”‚
â”‚  â”‚         â”‚           â”‚  â”‚  â”‚    â”‚                              â”‚   â”‚
â”‚  â”‚         â–¼           â”‚  â”‚  â”‚    â–¼                              â”‚   â”‚
â”‚  â”‚  Embedding + Index  â”‚  â”‚  â”‚  Context Assembly                â”‚   â”‚
â”‚  â”‚  â”œâ”€ Vector store    â”‚  â”‚  â”‚  â”œâ”€ Token budget alloc           â”‚   â”‚
â”‚  â”‚  â”œâ”€ BM25 index     â”‚  â”‚  â”‚  â”œâ”€ Source dedup                  â”‚   â”‚
â”‚  â”‚  â””â”€ Metadata store  â”‚  â”‚  â”‚  â””â”€ Parent expansion             â”‚   â”‚
â”‚  â”‚                     â”‚  â”‚  â”‚    â”‚                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚    â–¼                              â”‚   â”‚
â”‚                          â”‚  â”‚  LLM Generation                   â”‚   â”‚
â”‚  â”Œâ”€ FEEDBACK LOOP â”€â”€â”€â”€â”  â”‚  â”‚  â”œâ”€ Grounded answer              â”‚   â”‚
â”‚  â”‚ User thumbs up/down â”‚  â”‚  â”‚  â”œâ”€ Citation [1][2]              â”‚   â”‚
â”‚  â”‚ â†’ Fine-tune rerank  â”‚  â”‚  â”‚  â””â”€ Confidence score            â”‚   â”‚
â”‚  â”‚ â†’ Update chunking   â”‚  â”‚  â”‚    â”‚                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚    â–¼                              â”‚   â”‚
â”‚                          â”‚  â”‚  Response + Sources               â”‚   â”‚
â”‚                          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div>

<div class="highlight">
  <h4>ğŸ’¡ æ¶æ„æ ¸å¿ƒæ€æƒ³ / Core Design Principle</h4>
  <p><strong>ä¸­æ–‡</strong>ï¼šä¸ Day 3 è¯­ä¹‰æœç´¢ä¸åŒï¼ŒRAG ä¸åªæ˜¯"æ‰¾åˆ°æ–‡æ¡£"ï¼Œè€Œæ˜¯"æ‰¾åˆ°æ–‡æ¡£ + ç”Ÿæˆç­”æ¡ˆ + è¯æ˜ç­”æ¡ˆæ­£ç¡®"ã€‚ç³»ç»Ÿè¦åƒä¸€ä¸ªæœ‰æƒé™æ„è¯†çš„ç ”ç©¶åŠ©ç†ï¼Œä¸ä»…å›ç­”é—®é¢˜ï¼Œè¿˜è¦å¼•ç”¨å‡ºå¤„ã€‚</p>
  <p><strong>English</strong>: Unlike Day 3's semantic search (find documents), RAG means "find + generate + prove". The system acts as a permissions-aware research assistant that answers AND cites sources.</p>
</div>

<h2>âœ¨ è®¾è®¡äº®ç‚¹ 1: æ–‡æ¡£å¤„ç†æµæ°´çº¿ / Document Processing Pipeline</h2>

<div class="bilingual">
  <div class="zh">
    <h4>ä¸ºä»€ä¹ˆè¿™æ˜¯æœ€éš¾çš„éƒ¨åˆ†ï¼Ÿ</h4>
    <p>ä¼ä¸šæ–‡æ¡£ä¸åƒç½‘é¡µæ–‡æœ¬é‚£ä¹ˆå¹²å‡€ã€‚ä½ ä¼šé‡åˆ°ï¼š</p>
    <ul>
      <li>æ‰«æç‰ˆ PDFï¼ˆéœ€è¦ OCRï¼‰</li>
      <li>å¤æ‚è¡¨æ ¼ï¼ˆåˆå¹¶å•å…ƒæ ¼ã€åµŒå¥—è¡¨æ ¼ï¼‰</li>
      <li>PPT é‡Œçš„å›¾è¡¨å’Œæµç¨‹å›¾</li>
      <li>è·¨é¡µå¼•ç”¨å’Œè„šæ³¨</li>
    </ul>
    <h4>åˆ†å±‚è§£æç­–ç•¥</h4>
    <p><strong>Layer 1: Format Adapter</strong> â€” ç»Ÿä¸€ä¸åŒæ ¼å¼ä¸ºä¸­é—´è¡¨ç¤º</p>
    <p><strong>Layer 2: Layout Analysis</strong> â€” è¯†åˆ«æ ‡é¢˜ã€æ®µè½ã€è¡¨æ ¼ã€å›¾ç‰‡</p>
    <p><strong>Layer 3: Semantic Chunking</strong> â€” æŒ‰è¯­ä¹‰è¾¹ç•Œåˆ‡åˆ†ï¼Œä¿æŒä¸Šä¸‹æ–‡å®Œæ•´</p>
  </div>
  <div class="en">
    <h4>Why is this the hardest part?</h4>
    <p>Enterprise docs aren't clean like web text. You'll face:</p>
    <ul>
      <li>Scanned PDFs (need OCR)</li>
      <li>Complex tables (merged cells, nested)</li>
      <li>Charts and diagrams in PPTs</li>
      <li>Cross-page references and footnotes</li>
    </ul>
    <h4>Layered Parsing Strategy</h4>
    <p><strong>Layer 1: Format Adapter</strong> â€” Normalize different formats to intermediate representation</p>
    <p><strong>Layer 2: Layout Analysis</strong> â€” Detect headings, paragraphs, tables, images</p>
    <p><strong>Layer 3: Semantic Chunking</strong> â€” Split by semantic boundaries, preserve context</p>
  </div>
</div>

<pre><code>// Document Processing Pipeline
interface DocumentChunk {
  id: string;
  content: string;           // å®é™…æ–‡æœ¬å†…å®¹
  parentId: string | null;   // Parent-Child é“¾æ¥
  metadata: {
    source: string;          // æ–‡ä»¶å/URL
    page: number;            // é¡µç 
    section: string;         // ç« èŠ‚æ ‡é¢˜é“¾
    docType: 'pdf' | 'docx' | 'pptx' | 'html';
    department: string;      // æ‰€å±éƒ¨é—¨ (ACL)
    lastModified: Date;      // å¢é‡æ›´æ–°ç”¨
    confidence: number;      // OCR ç½®ä¿¡åº¦
  };
  embedding: number[];       // å‘é‡
}

// å…³é”®è®¾è®¡ï¼šHierarchical Chunking
// å° chunk ç”¨äºç²¾å‡†æ£€ç´¢ï¼Œå¤§ chunk ç”¨äºç»™ LLM å®Œæ•´ä¸Šä¸‹æ–‡
function hierarchicalChunk(doc: ParsedDocument): DocumentChunk[] {
  const sections = splitBySections(doc);       // Level 1: ç« èŠ‚çº§
  const paragraphs = sections.flatMap(s =>     // Level 2: æ®µè½çº§ (æ£€ç´¢ç”¨)
    splitByParagraphs(s, { maxTokens: 256 })
  );
  
  return paragraphs.map(p => ({
    ...p,
    parentId: p.section.id,  // é“¾æ¥åˆ°çˆ¶ç« èŠ‚
    // æ£€ç´¢å‘½ä¸­ paragraph â†’ è¿”å›æ•´ä¸ª section ç»™ LLM
  }));
}</code></pre>

<div class="highlight">
  <h4>ğŸ’¡ é¢è¯•å…³é”®ç‚¹</h4>
  <p><strong>ä¸­æ–‡</strong>ï¼šé¢è¯•å®˜æœ€çˆ±é—® "chunk å¤ªå°ä¼šæ€æ ·ï¼Ÿå¤ªå¤§ä¼šæ€æ ·ï¼Ÿ" â€” å° chunk æ£€ç´¢ç²¾å‡†ä½†ä¸Šä¸‹æ–‡ä¸è¶³ï¼Œå¤§ chunk ä¸Šä¸‹æ–‡ä¸°å¯Œä½†æ£€ç´¢å™ªéŸ³å¤§ã€‚<strong>Parent-Child Chunking</strong> æ˜¯æ ‡å‡†ç­”æ¡ˆï¼šå° chunk æ£€ç´¢ï¼Œè¿”å›å¤§ chunk ç»™ LLMã€‚</p>
  <p><strong>English</strong>: Interviewers love "what if chunks are too small/large?" â€” Small = precise retrieval but lacks context; Large = rich context but noisy retrieval. <strong>Parent-Child Chunking</strong> is the textbook answer: retrieve with small, feed LLM with large.</p>
</div>

<h2>âœ¨ è®¾è®¡äº®ç‚¹ 2: æƒé™æ„ŸçŸ¥æ£€ç´¢ / Permission-Aware Retrieval</h2>

<div class="bilingual">
  <div class="zh">
    <h4>ä¼ä¸š RAG vs é€šç”¨ RAG çš„æœ€å¤§åŒºåˆ«</h4>
    <p>é€šç”¨ RAGï¼ˆå¦‚ ChatGPT + æ–‡æ¡£ï¼‰ä¸éœ€è¦æƒé™ã€‚ä½†ä¼ä¸šåœºæ™¯ä¸‹ï¼š</p>
    <ul>
      <li>HR æ–‡æ¡£åªæœ‰ HR èƒ½æŸ¥</li>
      <li>è´¢åŠ¡æŠ¥å‘Šåªæœ‰ç®¡ç†å±‚èƒ½æŸ¥</li>
      <li>é¡¹ç›®æ–‡æ¡£åªæœ‰é¡¹ç›®ç»„èƒ½æŸ¥</li>
    </ul>
    <p>å…³é”®é—®é¢˜ï¼š<strong>æƒé™è¿‡æ»¤åœ¨å“ªé‡Œåšï¼Ÿ</strong></p>
    
    <h4>ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”</h4>
    <table>
      <tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr>
      <tr><td><strong>Pre-filter</strong><br>æ£€ç´¢å‰è¿‡æ»¤</td><td>å®‰å…¨æ€§æœ€é«˜</td><td>éœ€è¦ filtered vector search</td></tr>
      <tr><td><strong>Post-filter</strong><br>æ£€ç´¢åè¿‡æ»¤</td><td>å®ç°ç®€å•</td><td>âŒ æ³„éœ²é£é™© + ç»“æœä¸è¶³</td></tr>
      <tr><td><strong>Index-per-tenant</strong><br>ç§Ÿæˆ·ç‹¬ç«‹ç´¢å¼•</td><td>éš”ç¦»æœ€å½»åº•</td><td>æˆæœ¬é«˜ï¼Œç´¢å¼•çˆ†ç‚¸</td></tr>
    </table>
    
    <p>âœ… <strong>æ¨èæ–¹æ¡ˆï¼šPre-filter + ACL Bitmap</strong></p>
  </div>
  <div class="en">
    <h4>Enterprise RAG vs Generic RAG: The Key Difference</h4>
    <p>Generic RAG needs no permissions. But in enterprise:</p>
    <ul>
      <li>HR docs â†’ HR only</li>
      <li>Financial reports â†’ management only</li>
      <li>Project docs â†’ team members only</li>
    </ul>
    <p>Key question: <strong>Where to apply permission filtering?</strong></p>
    
    <h4>Three Approaches Compared</h4>
    <table>
      <tr><th>Approach</th><th>Pro</th><th>Con</th></tr>
      <tr><td><strong>Pre-filter</strong></td><td>Most secure</td><td>Needs filtered vector search</td></tr>
      <tr><td><strong>Post-filter</strong></td><td>Simple</td><td>âŒ Leak risk + sparse results</td></tr>
      <tr><td><strong>Index-per-tenant</strong></td><td>Best isolation</td><td>Costly, index explosion</td></tr>
    </table>
    
    <p>âœ… <strong>Recommended: Pre-filter + ACL Bitmap</strong></p>
  </div>
</div>

<pre><code>// Permission-Aware Vector Search
// ACL ä»¥ bitmap å½¢å¼å­˜å‚¨åœ¨å‘é‡å…ƒæ•°æ®ä¸­

interface ACLEntry {
  userId: string;
  groups: string[];     // ["engineering", "all-staff"]
  roles: string[];      // ["manager", "ic"]
}

// Qdrant ç¤ºä¾‹: å¸¦ ACL filter çš„å‘é‡æœç´¢
async function permissionAwareSearch(
  query: string,
  user: ACLEntry,
  topK: number = 20
): Promise<SearchResult[]> {
  const queryEmbedding = await embed(query);
  
  return qdrant.search({
    vector: queryEmbedding,
    limit: topK,
    filter: {
      should: [
        // ç”¨æˆ·ç›´æ¥æœ‰æƒé™çš„æ–‡æ¡£
        { key: "acl_users", match: { value: user.userId } },
        // ç”¨æˆ·æ‰€åœ¨ç»„æœ‰æƒé™çš„æ–‡æ¡£
        ...user.groups.map(g => ({
          key: "acl_groups", match: { value: g }
        })),
        // å…¨å‘˜å¯è§çš„æ–‡æ¡£
        { key: "acl_public", match: { value: true } }
      ]
    }
  });
}

// å…³é”®ä¼˜åŒ–: ACL å˜æ›´æ—¶ä¸éœ€è¦é‡æ–° embedï¼Œåªéœ€æ›´æ–° metadata
// è¿™æ¯” index-per-tenant çµæ´»å¾—å¤š</code></pre>

<div class="highlight-blue">
  <h4>ğŸ”— ä¸ Day 3 è¯­ä¹‰æœç´¢çš„å…³è”</h4>
  <p><strong>ä¸­æ–‡</strong>ï¼šDay 3 è®²çš„ Filtered HNSW å’Œ Pre-filter æŠ€æœ¯åœ¨è¿™é‡Œç›´æ¥åº”ç”¨ï¼ä¼ä¸š RAG çš„æƒé™è¿‡æ»¤æœ¬è´¨ä¸Šå°±æ˜¯ filtered vector searchã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å…ˆè®²æœç´¢å†è®² RAG â€” æœç´¢æ˜¯ RAG çš„æ ¸å¿ƒç»„ä»¶ã€‚</p>
  <p><strong>English</strong>: Day 3's Filtered HNSW and pre-filter techniques apply directly here! Enterprise RAG permission filtering IS filtered vector search. That's why we covered search before RAG â€” search is RAG's core component.</p>
</div>

<h2>âœ¨ è®¾è®¡äº®ç‚¹ 3: Query Understanding & Multi-Turn</h2>

<div class="bilingual">
  <div class="zh">
    <h4>ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ç”¨åŸå§‹ query æ£€ç´¢ï¼Ÿ</h4>
    <p>ä¼ä¸šåœºæ™¯çš„ query é€šå¸¸æœ‰è¿™äº›é—®é¢˜ï¼š</p>
    <ol>
      <li><strong>æ¨¡ç³ŠæŒ‡ä»£</strong>ï¼š"ä¸Šæ¬¡é‚£ä¸ªæ”¿ç­–æ›´æ–°äº†å—ï¼Ÿ" â€” "ä¸Šæ¬¡"æ˜¯ä»€ä¹ˆï¼Ÿ</li>
      <li><strong>çœç•¥ä¸»è¯­</strong>ï¼š"æŠ¥é”€æµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ" â†’ å“ªä¸ªéƒ¨é—¨çš„ï¼Ÿå›½å†…è¿˜æ˜¯æµ·å¤–ï¼Ÿ</li>
      <li><strong>å¤šè½®ä¾èµ–</strong>ï¼š"é‚£å¦‚æœè¶…è¿‡5000å‘¢ï¼Ÿ" â€” éœ€è¦å‰å‡ è½®ä¸Šä¸‹æ–‡</li>
    </ol>
    
    <h4>Query Understanding Pipeline</h4>
    <p><strong>Step 1: Intent Classification</strong> â€” é—®ç­” / æœç´¢ / é—²èŠ / æ“ä½œç±»</p>
    <p><strong>Step 2: History Fusion</strong> â€” å°†å¤šè½®å¯¹è¯å‹ç¼©ä¸ºç‹¬ç«‹ query</p>
    <p><strong>Step 3: Query Expansion</strong> â€” ç”ŸæˆåŒä¹‰ query å¢åŠ å¬å›ç‡</p>
  </div>
  <div class="en">
    <h4>Why can't we search with the raw query?</h4>
    <p>Enterprise queries often have:</p>
    <ol>
      <li><strong>Ambiguous references</strong>: "Did that policy get updated?" â€” which one?</li>
      <li><strong>Omitted context</strong>: "What's the reimbursement process?" â€” which dept? Domestic?</li>
      <li><strong>Multi-turn dependency</strong>: "What if it's over $5000?" â€” needs prior turns</li>
    </ol>
    
    <h4>Query Understanding Pipeline</h4>
    <p><strong>Step 1: Intent Classification</strong> â€” QA / Search / Chitchat / Action</p>
    <p><strong>Step 2: History Fusion</strong> â€” Compress multi-turn into standalone query</p>
    <p><strong>Step 3: Query Expansion</strong> â€” Generate synonym queries for better recall</p>
  </div>
</div>

<pre><code>// Multi-Turn Query Rewrite
// å°†ä¾èµ–ä¸Šä¸‹æ–‡çš„ query æ”¹å†™ä¸ºç‹¬ç«‹ query

const REWRITE_PROMPT = `
Given the conversation history and the latest user question,
rewrite the question to be standalone (self-contained).

History:
{history}

Latest question: {question}

Standalone question:`;

// ç¤ºä¾‹:
// History: "æˆ‘æƒ³äº†è§£æŠ¥é”€æ”¿ç­–" â†’ "å›½å†…å‡ºå·®çš„æŠ¥é”€æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿ"
// Latest: "é‚£æµ·å¤–çš„å‘¢ï¼Ÿ"
// Rewritten: "æµ·å¤–å‡ºå·®çš„æŠ¥é”€æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿ"

// Intent Router â€” ä¸æ˜¯æ‰€æœ‰ query éƒ½éœ€è¦ RAG
function routeQuery(query: string, intent: Intent): Pipeline {
  switch (intent) {
    case 'factual_qa':
      return ragPipeline;           // éœ€è¦æ£€ç´¢ â†’ å®Œæ•´ RAG
    case 'clarification':
      return clarificationPipeline; // è¿½é—® â†’ ç”¨å·²æœ‰ context å›ç­”
    case 'chitchat':
      return llmDirect;             // é—²èŠ â†’ ç›´æ¥ LLM
    case 'action':
      return actionPipeline;        // "å¸®æˆ‘åˆ›å»º..." â†’ Agent æ¨¡å¼
  }
}</code></pre>

<h2>âœ¨ è®¾è®¡äº®ç‚¹ 4: ç­”æ¡ˆç”Ÿæˆä¸æº¯æº / Grounded Generation & Citation</h2>

<div class="bilingual">
  <div class="zh">
    <h4>ä¼ä¸š RAG çš„ç”Ÿå‘½çº¿ï¼šå¯éªŒè¯æ€§</h4>
    <p>ä¼ä¸šä¸èƒ½å®¹å¿ hallucinationã€‚æ¯ä¸ªç­”æ¡ˆå¿…é¡»ï¼š</p>
    <ul>
      <li>âœ… åŸºäºæ£€ç´¢åˆ°çš„æ–‡æ¡£ç”Ÿæˆï¼ˆgroundedï¼‰</li>
      <li>âœ… æ ‡æ³¨å…·ä½“æ¥æº [1] [2]ï¼ˆcitationï¼‰</li>
      <li>âœ… å¯¹ä¸ç¡®å®šçš„å†…å®¹æ˜ç¡®è¯´"ä¸çŸ¥é“"</li>
    </ul>
    
    <h4>ä¸‰å±‚é˜²å¹»è§‰è®¾è®¡</h4>
    <p><strong>Layer 1: Prompt Engineering</strong> â€” ä¸¥æ ¼çº¦æŸåªç”¨ context å›ç­”</p>
    <p><strong>Layer 2: Citation Enforcement</strong> â€” è¦æ±‚æ¯ä¸ªå¥å­æ ‡æ³¨å‡ºå¤„</p>
    <p><strong>Layer 3: Post-Generation Check</strong> â€” NLI æ¨¡å‹éªŒè¯ç­”æ¡ˆä¸æºæ–‡æ¡£ä¸€è‡´æ€§</p>
  </div>
  <div class="en">
    <h4>Enterprise RAG Lifeline: Verifiability</h4>
    <p>Enterprises can't tolerate hallucination. Every answer must:</p>
    <ul>
      <li>âœ… Be grounded in retrieved documents</li>
      <li>âœ… Include specific citations [1] [2]</li>
      <li>âœ… Explicitly say "I don't know" when uncertain</li>
    </ul>
    
    <h4>Three-Layer Anti-Hallucination</h4>
    <p><strong>Layer 1: Prompt Engineering</strong> â€” Constrain to context only</p>
    <p><strong>Layer 2: Citation Enforcement</strong> â€” Require per-sentence attribution</p>
    <p><strong>Layer 3: Post-Generation Check</strong> â€” NLI model verifies answer-source consistency</p>
  </div>
</div>

<pre><code>// Grounded Generation Prompt
const GENERATION_PROMPT = `
You are an enterprise knowledge assistant. Answer the question
using ONLY the provided context. Follow these rules strictly:

1. Every factual claim MUST have a citation [1], [2], etc.
2. If the context doesn't contain enough info, say:
   "Based on available documents, I cannot fully answer this.
    Here's what I found: ..."
3. Never make up information not in the context.
4. If multiple sources conflict, present both views with citations.

Context:
{numbered_contexts}

Question: {question}

Answer (with citations):`;

// Post-Generation Faithfulness Check
interface FaithfulnessResult {
  score: number;          // 0-1
  unsupported: string[];  // æ²¡æœ‰æºæ–‡æ¡£æ”¯æ’‘çš„å¥å­
  conflicts: string[];    // ä¸æºæ–‡æ¡£çŸ›ç›¾çš„å¥å­
}

async function checkFaithfulness(
  answer: string,
  contexts: string[]
): Promise<FaithfulnessResult> {
  // 1. å°†ç­”æ¡ˆæ‹†åˆ†ä¸ºåŸå­å£°æ˜ (atomic claims)
  const claims = await extractClaims(answer);
  
  // 2. å¯¹æ¯ä¸ªå£°æ˜ï¼Œç”¨ NLI æ¨¡å‹æ£€æŸ¥æ˜¯å¦è¢« context æ”¯æŒ
  const results = await Promise.all(
    claims.map(claim => nliModel.classify(claim, contexts))
    // 'entailment' | 'contradiction' | 'neutral'
  );
  
  // 3. å¦‚æœ faithfulness < 0.8ï¼Œè§¦å‘é‡æ–°ç”Ÿæˆ
  const score = results.filter(r => r === 'entailment').length / results.length;
  if (score < 0.8) {
    return regenerateWithStricterPrompt(answer, contexts);
  }
  return { score, unsupported, conflicts };
}</code></pre>

<h2>âœ¨ è®¾è®¡äº®ç‚¹ 5: å¢é‡æ›´æ–°æ¶æ„ / Incremental Update</h2>

<div class="bilingual">
  <div class="zh">
    <h4>æ–‡æ¡£æ›´æ–°æ˜¯ä¼ä¸š RAG çš„å¸¸æ€</h4>
    <p>æ”¿ç­–æ–‡æ¡£ã€äº§å“æ‰‹å†Œã€FAQ éšæ—¶åœ¨æ›´æ–°ã€‚ä¸èƒ½æ¯æ¬¡å…¨é‡é‡å»ºç´¢å¼•ã€‚</p>
    
    <h4>CDC (Change Data Capture) æ¨¡å¼</h4>
    <ul>
      <li><strong>Webhook / API ç›‘å¬</strong>ï¼šConfluenceã€Notion çš„æ–‡æ¡£å˜æ›´äº‹ä»¶</li>
      <li><strong>æ–‡ä»¶ç³»ç»Ÿç›‘å¬</strong>ï¼šS3 äº‹ä»¶é€šçŸ¥ / fswatch</li>
      <li><strong>å®šæ—¶ Diff</strong>ï¼šå¯¹æ¯” hash å€¼å‘ç°å˜æ›´</li>
    </ul>
    
    <h4>æ›´æ–°ç­–ç•¥</h4>
    <p>æ–‡æ¡£æ›´æ–° â†’ åˆ é™¤æ—§ chunks â†’ é‡æ–°è§£æ â†’ é‡æ–° embed â†’ æ›´æ–°ç´¢å¼•</p>
    <p>å…³é”®ï¼šç”¨ <code>doc_id + version</code> ä½œä¸º chunk çš„ namespaceï¼ŒåŸå­æ›¿æ¢ã€‚</p>
  </div>
  <div class="en">
    <h4>Document updates are the norm in enterprise</h4>
    <p>Policies, manuals, FAQs change constantly. Can't rebuild index from scratch.</p>
    
    <h4>CDC (Change Data Capture) Pattern</h4>
    <ul>
      <li><strong>Webhooks</strong>: Confluence/Notion change events</li>
      <li><strong>File system watch</strong>: S3 events / fswatch</li>
      <li><strong>Scheduled Diff</strong>: Compare hashes to detect changes</li>
    </ul>
    
    <h4>Update Strategy</h4>
    <p>Doc updated â†’ delete old chunks â†’ re-parse â†’ re-embed â†’ update index</p>
    <p>Key: Use <code>doc_id + version</code> as chunk namespace for atomic replacement.</p>
  </div>
</div>

<h2>ğŸ“Š å®¹é‡ä¼°ç®— / Capacity Estimation</h2>

<div class="architecture">
<h4>å‡è®¾: ä¸­å¤§å‹ä¼ä¸š (10K employees, 500K documents)</h4>

<table>
  <tr><th>æŒ‡æ ‡</th><th>ä¼°ç®—</th><th>è®¡ç®—</th></tr>
  <tr><td>æ–‡æ¡£æ€»é‡</td><td>500K docs</td><td>å„éƒ¨é—¨æ–‡æ¡£ç´¯è®¡</td></tr>
  <tr><td>å¹³å‡ chunks/doc</td><td>~20</td><td>å¹³å‡ 5 é¡µ Ã— 4 chunks/é¡µ</td></tr>
  <tr><td>æ€» chunks</td><td>10M</td><td>500K Ã— 20</td></tr>
  <tr><td>å‘é‡ç»´åº¦</td><td>768d (float32)</td><td>BGE-base / E5-base</td></tr>
  <tr><td>å‘é‡å­˜å‚¨</td><td>~30 GB</td><td>10M Ã— 768 Ã— 4 bytes</td></tr>
  <tr><td>Metadata å­˜å‚¨</td><td>~5 GB</td><td>10M Ã— 500 bytes avg</td></tr>
  <tr><td>QPS (é«˜å³°)</td><td>~100</td><td>10K employees Ã— 1% active</td></tr>
  <tr><td>æ¯æ¬¡æ£€ç´¢ Top-K</td><td>20 â†’ rerank â†’ 5</td><td>æ£€ç´¢ 20, ç²¾æ’å– 5</td></tr>
  <tr><td>LLM è°ƒç”¨/query</td><td>1-2 æ¬¡</td><td>ç”Ÿæˆ + å¯é€‰ faithfulness check</td></tr>
  <tr><td>æ—¥æ›´æ–°æ–‡æ¡£</td><td>~500</td><td>0.1% æ–‡æ¡£æ—¥å˜æ›´</td></tr>
</table>

<h4>æˆæœ¬ä¼°ç®— (Monthly)</h4>
<table>
  <tr><th>ç»„ä»¶</th><th>æ–¹æ¡ˆ</th><th>æœˆæˆæœ¬</th></tr>
  <tr><td>Vector DB</td><td>Qdrant Cloud (30GB)</td><td>~$200</td></tr>
  <tr><td>Embedding</td><td>Self-hosted BGE-base</td><td>~$100 (GPU)</td></tr>
  <tr><td>Reranker</td><td>Cohere Rerank API</td><td>~$300</td></tr>
  <tr><td>LLM (Generation)</td><td>GPT-4o-mini</td><td>~$500</td></tr>
  <tr><td>LLM (Query Rewrite)</td><td>GPT-4o-mini</td><td>~$100</td></tr>
  <tr><td><strong>Total</strong></td><td></td><td><strong>~$1,200/mo</strong></td></tr>
</table>
</div>

<h2>ğŸ“ é¢è¯•é«˜é¢‘é—®é¢˜ / Interview Questions</h2>

<div class="interview-q">
  <strong>Q1: RAG ç³»ç»Ÿ vs ç›´æ¥ Fine-tune LLMï¼Œä»€ä¹ˆåœºæ™¯ç”¨å“ªä¸ªï¼Ÿ</strong>
</div>
<div class="interview-a">
  <p><strong>RAG ä¼˜åŠ¿</strong>ï¼šçŸ¥è¯†é¢‘ç¹æ›´æ–°ã€éœ€è¦æº¯æºã€æ•°æ®éšç§æ•æ„Ÿã€é•¿å°¾çŸ¥è¯†å¤šã€‚<strong>Fine-tune ä¼˜åŠ¿</strong>ï¼šéœ€è¦ç‰¹å®šè¯­æ°”/æ ¼å¼ã€é¢†åŸŸæœ¯è¯­ç†è§£ã€å»¶è¿Ÿæ•æ„Ÿã€‚</p>
  <p><strong>é»„é‡‘æ³•åˆ™</strong>ï¼šRAG æ”¹å˜æ¨¡å‹"çŸ¥é“ä»€ä¹ˆ"(knowledge)ï¼ŒFine-tune æ”¹å˜æ¨¡å‹"æ€ä¹ˆè¯´"(behavior)ã€‚å¤§å¤šæ•°ä¼ä¸šåœºæ™¯ç”¨ RAG + è½»é‡ fine-tune (style tuning) ç»„åˆã€‚</p>
  <p><strong>é¢è¯•åŠ åˆ†</strong>ï¼šæåˆ°"RAG çš„çŸ¥è¯†éšæ—¶æ›´æ–°ä¸éœ€è¦é‡è®­ç»ƒ"å’Œ"fine-tune æœ‰ç¾éš¾æ€§é—å¿˜é£é™©"ã€‚</p>
</div>

<div class="interview-q">
  <strong>Q2: å¦‚ä½•å¤„ç†è·¨æ–‡æ¡£çš„å¤åˆé—®é¢˜ï¼Ÿæ¯”å¦‚"A æ”¿ç­–å’Œ B æ”¿ç­–çš„å·®å¼‚æ˜¯ä»€ä¹ˆï¼Ÿ"</strong>
</div>
<div class="interview-a">
  <p>è¿™æ˜¯ <strong>Multi-Hop Retrieval</strong> åœºæ™¯ã€‚ä¸‰ç§æ–¹æ¡ˆï¼š</p>
  <ol>
    <li><strong>Query Decomposition</strong>ï¼šLLM å…ˆå°†å¤åˆé—®é¢˜æ‹†ä¸ºå­é—®é¢˜ â†’ åˆ†åˆ«æ£€ç´¢ â†’ åˆå¹¶ç”Ÿæˆ</li>
    <li><strong>Iterative Retrieval</strong>ï¼šç¬¬ä¸€è½®æ£€ç´¢ A æ”¿ç­– â†’ åŸºäºç»“æœç”Ÿæˆç¬¬äºŒè½® query â†’ æ£€ç´¢ B æ”¿ç­–</li>
    <li><strong>Graph-Enhanced RAG</strong>ï¼šæ–‡æ¡£é—´å»ºå…³ç³»å›¾ï¼Œæ£€ç´¢æ—¶æ²¿è¾¹æ‰©å±•åˆ°ç›¸å…³æ–‡æ¡£</li>
  </ol>
  <p><strong>å®è·µé€‰æ‹©</strong>ï¼šQuery Decomposition æœ€å®ç”¨ï¼ˆä¸€æ¬¡ LLM call + å¹¶è¡Œæ£€ç´¢ï¼‰ï¼ŒGraph RAG å¯¹åŸºç¡€è®¾æ–½è¦æ±‚é«˜ä½†æ•ˆæœæœ€å¥½ã€‚</p>
</div>

<div class="interview-q">
  <strong>Q3: æ–‡æ¡£æ›´æ–°åï¼Œç”¨æˆ·çœ‹åˆ°çš„ç­”æ¡ˆä»ç„¶å¼•ç”¨æ—§ç‰ˆæœ¬æ€ä¹ˆåŠï¼Ÿ</strong>
</div>
<div class="interview-a">
  <p>è¿™æ˜¯ <strong>Staleness Problem</strong>ã€‚åˆ†å±‚è§£å†³ï¼š</p>
  <ol>
    <li><strong>å®æ—¶å±‚</strong>ï¼šæ–‡æ¡£æ›´æ–° webhook â†’ 5 åˆ†é’Ÿå†…åˆ é™¤æ—§ chunks + æ’å…¥æ–° chunks</li>
    <li><strong>ç¼“å­˜å¤±æ•ˆ</strong>ï¼šSemantic Cache çš„ key åŒ…å« doc_versionï¼Œæ–‡æ¡£æ›´æ–°è‡ªåŠ¨å¤±æ•ˆ</li>
    <li><strong>ç‰ˆæœ¬æ ‡æ³¨</strong>ï¼šç­”æ¡ˆä¸­æ ‡æ³¨"åŸºäº 2026-02-13 ç‰ˆæœ¬"ï¼Œç”¨æˆ·å¯åˆ¤æ–­æ—¶æ•ˆæ€§</li>
    <li><strong>å†²çªæ£€æµ‹</strong>ï¼šæ–°æ—§æ–‡æ¡£å¹¶å­˜æ—¶æ£€æµ‹çŸ›ç›¾ï¼Œæ ‡æ³¨"æ­¤æ–‡æ¡£è¿‘æœŸæœ‰æ›´æ–°"</li>
  </ol>
</div>

<div class="interview-q">
  <strong>Q4: å¦‚ä½•è¡¡é‡ RAG ç³»ç»Ÿçš„æ•ˆæœï¼Ÿä¸Šçº¿åæ€ä¹ˆæŒç»­ä¼˜åŒ–ï¼Ÿ</strong>
</div>
<div class="interview-a">
  <p><strong>ç¦»çº¿è¯„ä¼° (RAGAS æ¡†æ¶)</strong>ï¼š</p>
  <ul>
    <li>Faithfulnessï¼ˆç­”æ¡ˆæ˜¯å¦åŸºäº contextï¼‰â€” é˜²å¹»è§‰æ ¸å¿ƒæŒ‡æ ‡</li>
    <li>Answer Relevancyï¼ˆç­”æ¡ˆæ˜¯å¦åˆ‡é¢˜ï¼‰</li>
    <li>Context Precisionï¼ˆæ£€ç´¢åˆ°çš„æ˜¯å¦æœ‰ç”¨ï¼‰</li>
    <li>Context Recallï¼ˆæ˜¯å¦é—æ¼äº†ç›¸å…³æ–‡æ¡£ï¼‰</li>
  </ul>
  <p><strong>åœ¨çº¿æŒ‡æ ‡</strong>ï¼š</p>
  <ul>
    <li>User feedback (ğŸ‘/ğŸ‘) â€” æœ€ç›´æ¥çš„ä¿¡å·</li>
    <li>Click-through on citations â€” ç”¨æˆ·æ˜¯å¦éªŒè¯äº†æ¥æº</li>
    <li>"I don't know" rate â€” å¤ªé«˜è¯´æ˜æ£€ç´¢ä¸è¶³ï¼Œå¤ªä½è¯´æ˜å¯èƒ½åœ¨ç¼–</li>
    <li>Latency P95/P99</li>
  </ul>
  <p><strong>æŒç»­ä¼˜åŒ–é—­ç¯</strong>ï¼šæ”¶é›† thumbs-down â†’ åˆ†æ bad case â†’ æ˜¯æ£€ç´¢é—®é¢˜(è°ƒ chunking/retrieval)è¿˜æ˜¯ç”Ÿæˆé—®é¢˜(è°ƒ prompt/reranker) â†’ A/B æµ‹è¯• â†’ ä¸Šçº¿</p>
</div>

<h2>ğŸ“š ä¸ç³»åˆ—å…¶ä»–ç¯‡ç›®çš„å…³è” / Series Connections</h2>

<div class="highlight-blue">
  <table>
    <tr><th>æ¦‚å¿µ</th><th>æœ¬ç¯‡ (RAG çŸ¥è¯†åº“)</th><th>å‰ç¯‡å…³è”</th></tr>
    <tr><td>å‘é‡æœç´¢</td><td>Hybrid Search + ACL Filter</td><td>Day 3 Filtered HNSW, RRF</td></tr>
    <tr><td>æµå¼è¾“å‡º</td><td>SSE ç­”æ¡ˆç”Ÿæˆ</td><td>Day 1 ChatGPT SSE æ¶æ„</td></tr>
    <tr><td>Reranker</td><td>Cross-Encoder ç²¾æ’</td><td>Day 3 Bi-Encoder vs Cross-Encoder</td></tr>
    <tr><td>ç‰¹å¾å·¥ç¨‹</td><td>Document Metadata</td><td>Day 2 Feature Store</td></tr>
    <tr><td>å®‰å…¨</td><td>Anti-Hallucination + ACL</td><td>Day 1 Safety å››è¦ç´ </td></tr>
  </table>
  <p>ğŸ¯ <strong>ç³»åˆ—è®¾è®¡æ€è·¯</strong>ï¼šDay 1-3 å»ºç«‹äº†æ ¸å¿ƒç»„ä»¶çŸ¥è¯†ï¼ˆå¯¹è¯ã€æ¨èã€æœç´¢ï¼‰ï¼ŒDay 4 (æœ¬ç¯‡) å°†å®ƒä»¬ç»„åˆæˆä¸€ä¸ªå®Œæ•´çš„ç«¯åˆ°ç«¯ç³»ç»Ÿã€‚è¿™å°±æ˜¯ system design é¢è¯•çš„å…³é”® â€” ä¸æ˜¯å‘æ˜æ–°ç»„ä»¶ï¼Œè€Œæ˜¯ç»„åˆå·²æœ‰ç»„ä»¶è§£å†³æ–°é—®é¢˜ã€‚</p>
</div>

<div class="follow-up">
  <h3>ğŸ’¬ åç»­è®¨è®º / Follow-up Topics</h3>
  <ul>
    <li>ğŸ”œ <strong>Day 5</strong>: è®¾è®¡ AI Code Review ç³»ç»Ÿ â€” å°† RAG åº”ç”¨åˆ°ä»£ç åˆ†æåœºæ™¯</li>
    <li>æƒ³æ·±å…¥å“ªä¸ªéƒ¨åˆ†ï¼ŸDocument parsing? Graph RAG? Evaluation pipeline?</li>
  </ul>
</div>

<p style="text-align: center; color: #9aa0a6; margin-top: 40px;">
  Friday's Daily AI Push ğŸ“š | 2026-02-13 | Phase 2.1 Day 4/5
</p>

</body>
</html>
