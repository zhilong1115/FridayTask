<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>2026-02-14 - è®¾è®¡ AI Code Review ç³»ç»Ÿ</title>
  <style>
    body { font-family: -apple-system, system-ui, sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; line-height: 1.8; color: #1a1a1a; }
    .bilingual { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    .zh { border-left: 3px solid #f9ab00; padding-left: 15px; }
    .en { border-left: 3px solid #1a73e8; padding-left: 15px; }
    h1 { color: #3c4043; border-bottom: 2px solid #e8eaed; padding-bottom: 10px; }
    h2 { color: #1a73e8; margin-top: 40px; }
    h3 { color: #5f6368; }
    .architecture { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0; }
    pre { background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 13px; }
    code { font-family: 'SF Mono', Monaco, monospace; }
    .highlight { background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; }
    .highlight-blue { background: #e8f0fe; padding: 15px; border-radius: 8px; margin: 15px 0; }
    .highlight-green { background: #e6f4ea; padding: 15px; border-radius: 8px; margin: 15px 0; }
    .diagram { background: #f0f0f0; padding: 20px; border-radius: 8px; margin: 20px 0; font-family: monospace; font-size: 13px; white-space: pre; overflow-x: auto; line-height: 1.4; }
    .interview { background: #fce8e6; padding: 15px; border-radius: 8px; margin: 15px 0; }
    .tag { display: inline-block; background: #e8eaed; padding: 2px 8px; border-radius: 4px; font-size: 12px; margin: 2px; }
    table { border-collapse: collapse; width: 100%; margin: 15px 0; }
    th, td { border: 1px solid #dadce0; padding: 10px; text-align: left; }
    th { background: #f8f9fa; }
    .series-nav { background: #e8f0fe; padding: 15px; border-radius: 8px; margin: 20px 0; }
    .metric { font-size: 24px; font-weight: bold; color: #1a73e8; }
  </style>
</head>
<body>

<div class="series-nav">
  <strong>ğŸ“‹ AI System Design é¢è¯•é¢˜ç³»åˆ— | Day 5 of 5 â€” ç³»åˆ—å®Œç»“ç¯‡ï¼</strong><br>
  Day 1: <a href="2026-02-10-design-chatgpt-system.html">è®¾è®¡ ChatGPT</a> â†’
  Day 2: <a href="2026-02-11-design-recommendation-system.html">è®¾è®¡æ¨èç³»ç»Ÿ</a> â†’
  Day 3: <a href="2026-02-12-design-semantic-search-engine.html">è®¾è®¡è¯­ä¹‰æœç´¢å¼•æ“</a> â†’
  Day 4: <a href="2026-02-13-design-rag-knowledge-base.html">è®¾è®¡ RAG çŸ¥è¯†åº“</a> â†’
  <strong>Day 5: è®¾è®¡ AI Code Review ç³»ç»Ÿ</strong> ğŸ¯
</div>

<h1>ğŸ” è®¾è®¡ AI Code Review ç³»ç»Ÿ â€” System Design</h1>
<p><span class="tag">AI System Design</span> <span class="tag">Code Review</span> <span class="tag">AST</span> <span class="tag">LLM</span> <span class="tag">é¢è¯•é«˜é¢‘</span></p>
<p>å‚è€ƒäº§å“: CodeRabbit, Qodo (PR-Agent), GitHub Copilot Code Review, Baz Reviewer</p>

<h2>ğŸ“– é¢˜ç›® / Problem Statement</h2>
<div class="bilingual">
  <div class="zh">
    <p><strong>é¢è¯•å®˜ï¼š</strong>è¯·è®¾è®¡ä¸€ä¸ª AI ä»£ç å®¡æŸ¥ç³»ç»Ÿï¼Œåƒ CodeRabbit ä¸€æ ·ï¼Œåœ¨å¼€å‘è€…æäº¤ PR æ—¶è‡ªåŠ¨ç”Ÿæˆæœ‰æ„ä¹‰çš„ä»£ç å®¡æŸ¥æ„è§ã€‚</p>
    <p><strong>æ ¸å¿ƒéœ€æ±‚ï¼š</strong></p>
    <ul>
      <li>æ¯å¤©å¤„ç† 10 ä¸‡+ PRï¼Œå¹³å‡æ¯ä¸ª PR ä¿®æ”¹ 15 ä¸ªæ–‡ä»¶</li>
      <li>ç†è§£ä»£ç å˜æ›´çš„è¯­ä¹‰ï¼ˆä¸æ˜¯ç®€å• lintï¼‰</li>
      <li>æ„ŸçŸ¥é¡¹ç›®ä¸Šä¸‹æ–‡ã€å†å²å†³ç­–ã€å›¢é˜Ÿè§„èŒƒ</li>
      <li>ç”Ÿæˆ inline çº§åˆ«çš„å®¡æŸ¥æ„è§ + PR çº§åˆ«çš„æ€»ç»“</li>
      <li>æ”¯æŒå¤šè¯­è¨€ï¼ˆPython, TypeScript, Go, Java, Rust...ï¼‰</li>
      <li>ä½å»¶è¿Ÿï¼ˆPR æäº¤å 2-5 åˆ†é’Ÿå†…å®Œæˆï¼‰</li>
    </ul>
  </div>
  <div class="en">
    <p><strong>Interviewer:</strong> Design an AI code review system that automatically generates meaningful review comments when developers submit PRs, similar to CodeRabbit.</p>
    <p><strong>Core requirements:</strong></p>
    <ul>
      <li>Process 100K+ PRs/day, avg 15 files changed per PR</li>
      <li>Understand semantic meaning of changes (not just linting)</li>
      <li>Context-aware: project history, design decisions, team conventions</li>
      <li>Generate inline comments + PR-level summaries</li>
      <li>Multi-language support</li>
      <li>Low latency: complete within 2-5 min of PR submission</li>
    </ul>
  </div>
</div>

<h2>ğŸ—ï¸ é«˜å±‚æ¶æ„ / High-Level Architecture</h2>

<div class="diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GitHub / GitLab Webhook                       â”‚
â”‚                    (PR opened / synchronized)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     1. INGESTION LAYER                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Webhook  â”‚â†’ â”‚ PR Metadata  â”‚â†’ â”‚ Diff Parser  â”‚â†’ â”‚ File Fetch â”‚  â”‚
â”‚  â”‚ Receiver â”‚  â”‚ Extractor    â”‚  â”‚ (Difftastic) â”‚  â”‚ (Full Ctx) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     2. CONTEXT ASSEMBLY LAYER                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ AST Parser   â”‚  â”‚ Dependency   â”‚  â”‚ Knowledge Graph Query    â”‚  â”‚
â”‚  â”‚ (Tree-sitter)â”‚  â”‚ Graph Builderâ”‚  â”‚ (history, issues, rules) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                            â”‚                                         â”‚
â”‚                    Context Package                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     3. REVIEW ENGINE (LLM)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ File-Level   â”‚  â”‚ PR-Level     â”‚  â”‚ Verification Agent       â”‚  â”‚
â”‚  â”‚ Reviewer     â”‚  â”‚ Summarizer   â”‚  â”‚ (reduce false positives) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     4. OUTPUT & FEEDBACK LAYER                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Comment      â”‚  â”‚ De-duplicate â”‚  â”‚ Learning Loop            â”‚  â”‚
â”‚  â”‚ Formatter    â”‚  â”‚ & Prioritize â”‚  â”‚ (thumbs up/down â†’ finetune)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div>

<h2>ğŸ”§ æ ¸å¿ƒç»„ä»¶æ·±å…¥ / Deep Dive</h2>

<h3>ç»„ä»¶ 1: Diff è§£æ â€” è¶…è¶Š git diff</h3>

<div class="bilingual">
  <div class="zh">
    <p><strong>é—®é¢˜ï¼š</strong>git diff æ˜¯çº¯æ–‡æœ¬å¯¹æ¯”ï¼Œå®ƒä¸ç†è§£ä»£ç ç»“æ„ã€‚ä¸€ä¸ªç®€å•çš„è‡ªåŠ¨æ ¼å¼åŒ–å¯èƒ½äº§ç”Ÿä¸Šç™¾è¡Œ diffï¼Œä½†è¯­ä¹‰å®Œå…¨æ²¡å˜ã€‚</p>
    <p><strong>ä¸‰å±‚ diff ç­–ç•¥ï¼š</strong></p>
    <ol>
      <li><strong>Text Diff (git diff)</strong> â€” åŸºç¡€å±‚ï¼Œè·å–å˜æ›´çš„è¡Œ</li>
      <li><strong>Syntax Diff (Difftastic)</strong> â€” è¯­æ³•æ„ŸçŸ¥ï¼Œè¿‡æ»¤æ ¼å¼å™ªéŸ³ï¼Œåªå…³æ³¨é€»è¾‘å˜æ›´</li>
      <li><strong>Semantic Diff (Tree-sitter AST)</strong> â€” ç»“æ„åŒ–ç†è§£ï¼šå‡½æ•°é‡å‘½åã€å‚æ•°å˜åŒ–ã€ä¾èµ–é“¾</li>
    </ol>
    <p><strong>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼š</strong>LLM çš„ context window æœ‰é™ï¼Œç»™å®ƒä¸€å †æ ¼å¼å˜æ›´çš„ diff å°±æ˜¯æµªè´¹ tokenã€‚Difftastic è¿‡æ»¤å™ªéŸ³å¯ä»¥èŠ‚çœ 40-60% çš„ tokenï¼Œè®© LLM ä¸“æ³¨äºçœŸæ­£æœ‰æ„ä¹‰çš„å˜æ›´ã€‚</p>
  </div>
  <div class="en">
    <p><strong>Problem:</strong> git diff is text-level comparison, unaware of code structure. Auto-formatting can produce 100+ line diffs with zero semantic change.</p>
    <p><strong>Three-tier diff strategy:</strong></p>
    <ol>
      <li><strong>Text Diff (git diff)</strong> â€” Base layer, lines changed</li>
      <li><strong>Syntax Diff (Difftastic)</strong> â€” Grammar-aware, filters formatting noise</li>
      <li><strong>Semantic Diff (Tree-sitter AST)</strong> â€” Structural: renames, param changes, dependency chains</li>
    </ol>
    <p><strong>Why:</strong> LLM context windows are finite. Feeding formatting noise wastes tokens. Difftastic filters save 40-60% tokens, letting the LLM focus on meaningful changes.</p>
  </div>
</div>

<pre><code>// Tree-sitter AST diff example â€” detect function signature change
// Before:
function processOrder(order: Order): Result { ... }

// After:  
async function processOrder(order: Order, options?: ProcessOptions): Promise&lt;Result&gt; { ... }

// AST diff detects:
// 1. Function became async (behavioral change!)
// 2. New optional parameter added (API change)
// 3. Return type changed to Promise (all callers must handle async)
// â†’ These are HIGH-SIGNAL changes worth reviewing

// Meanwhile, git diff would also show:
// - Indentation changes in the function body (noise)
// - Blank line additions (noise)
// â†’ Difftastic filters these out</code></pre>

<h3>ç»„ä»¶ 2: Context Assembly â€” ä¸‰å±‚ä¸Šä¸‹æ–‡å·¥ç¨‹</h3>

<div class="highlight">
  <h4>ğŸ’¡ æ ¸å¿ƒæ´å¯Ÿï¼šContext Engineering > Prompt Engineering</h4>
  <p>CodeRabbit çš„æ ¸å¿ƒç«äº‰åŠ›ä¸æ˜¯æ›´å¥½çš„ promptï¼Œè€Œæ˜¯æ›´å¥½çš„ contextã€‚ç»™ LLM æ­£ç¡®çš„ä¸Šä¸‹æ–‡ï¼Œæ¯”è°ƒ prompt é‡è¦ 10xã€‚</p>
</div>

<div class="bilingual">
  <div class="zh">
    <p><strong>ä¸‰å±‚ä¸Šä¸‹æ–‡æ¨¡å‹ï¼š</strong></p>
    <p><strong>Layer 1: Code Contextï¼ˆä»£ç å±‚ï¼‰</strong></p>
    <ul>
      <li><strong>å˜æ›´æ–‡ä»¶çš„å®Œæ•´å†…å®¹</strong>ï¼ˆä¸åªæ˜¯ diff hunkï¼‰</li>
      <li><strong>å…³è”æ–‡ä»¶</strong>ï¼šimport çš„æ¨¡å—ã€è¢«å¼•ç”¨çš„ç±»å‹å®šä¹‰</li>
      <li><strong>è°ƒç”¨é“¾</strong>ï¼šè°è°ƒç”¨äº†è¢«ä¿®æ”¹çš„å‡½æ•°ï¼Ÿä¿®æ”¹ä¼šå½±å“è°ï¼Ÿ</li>
    </ul>
    <p><strong>Layer 2: Project Contextï¼ˆé¡¹ç›®å±‚ï¼‰</strong></p>
    <ul>
      <li><strong>å†å² PR</strong>ï¼šè¿™ä¸ªæ–‡ä»¶ / æ¨¡å—è¿‡å»æ”¹è¿‡ä»€ä¹ˆï¼Ÿä¸Šæ¬¡ review æäº†ä»€ä¹ˆæ„è§ï¼Ÿ</li>
      <li><strong>Issue/Ticket</strong>ï¼šè¿™ä¸ª PR å…³è”çš„ Jira/Linear ticketï¼Œç†è§£å¼€å‘è€…çš„ intent</li>
      <li><strong>Architecture Rules</strong>ï¼šé¡¹ç›®çº§åˆ«çš„çº¦å®šï¼ˆå¦‚ "æ‰€æœ‰ API éƒ½è¦ç»è¿‡ auth middleware"ï¼‰</li>
    </ul>
    <p><strong>Layer 3: Team Contextï¼ˆå›¢é˜Ÿå±‚ï¼‰</strong></p>
    <ul>
      <li><strong>Review Learnings</strong>ï¼šä¹‹å‰ reviewer ç»™çš„ thumbs up/downï¼Œå­¦ä¹ å›¢é˜Ÿåå¥½</li>
      <li><strong>Custom Instructions</strong>ï¼šå›¢é˜Ÿè‡ªå®šä¹‰è§„åˆ™ï¼ˆå¦‚ "æˆ‘ä»¬ç”¨ Result ç±»å‹è€Œä¸æ˜¯ throw"ï¼‰</li>
      <li><strong>Tribal Knowledge</strong>ï¼šä¸æˆæ–‡è§„èŒƒï¼ˆ"input validation æ”¾åœ¨ lib/security"ï¼‰</li>
    </ul>
  </div>
  <div class="en">
    <p><strong>Three-layer context model:</strong></p>
    <p><strong>Layer 1: Code Context</strong></p>
    <ul>
      <li>Full file content (not just diff hunks)</li>
      <li>Related files: imported modules, referenced type definitions</li>
      <li>Call chain: who calls modified functions? Who's affected?</li>
    </ul>
    <p><strong>Layer 2: Project Context</strong></p>
    <ul>
      <li>Historical PRs: past changes to this file/module, prior review comments</li>
      <li>Issues/Tickets: linked Jira/Linear tickets reveal developer intent</li>
      <li>Architecture rules: project-level conventions</li>
    </ul>
    <p><strong>Layer 3: Team Context</strong></p>
    <ul>
      <li>Review learnings: past thumbs up/down feedback</li>
      <li>Custom instructions: team-specific rules</li>
      <li>Tribal knowledge: unwritten conventions</li>
    </ul>
  </div>
</div>

<div class="diagram">
Context Assembly Pipeline:

PR Webhook
    â”‚
    â”œâ”€â”€â†’ Git API â”€â”€â†’ Diff + Full Files â”€â”€â†’ â”
    â”‚                                       â”‚
    â”œâ”€â”€â†’ Tree-sitter â”€â”€â†’ AST + Call Graph â”€â”€â”¤
    â”‚                                       â”‚
    â”œâ”€â”€â†’ Vector DB â”€â”€â†’ Similar Past PRs â”€â”€â”€â”€â”¤â”€â”€â†’ Context
    â”‚    (LanceDB)     Related Code         â”‚    Package
    â”‚                                       â”‚
    â”œâ”€â”€â†’ Issue Tracker â”€â”€â†’ Ticket Context â”€â”€â”¤
    â”‚    (Jira/Linear)                      â”‚
    â”‚                                       â”‚
    â””â”€â”€â†’ Rules DB â”€â”€â†’ Custom Instructions â”€â”€â”˜
              Team Learnings

Token Budget: ~100K tokens per review
  - Diff + Full Files: ~40K (40%)
  - AST / Call Graph:  ~15K (15%)
  - Historical PRs:    ~20K (20%)
  - Issue Context:     ~10K (10%)
  - Rules + Learnings: ~15K (15%)
</div>

<h3>ç»„ä»¶ 3: Review Engine â€” Pipeline vs Agentic</h3>

<div class="bilingual">
  <div class="zh">
    <p><strong>å…³é”®æ¶æ„å†³ç­–ï¼šPipeline è¿˜æ˜¯ Agenticï¼Ÿ</strong></p>
    <p>è¿™æ˜¯é¢è¯•ä¸­çš„é«˜åˆ†ç­”é¢˜ç‚¹ã€‚ä¸¤ç§æ¨¡å¼å„æœ‰é€‚ç”¨åœºæ™¯ï¼š</p>
    
    <p><strong>Pipeline æ¨¡å¼ï¼ˆæ¨èåŸºç¡€æ¶æ„ï¼‰ï¼š</strong></p>
    <ul>
      <li>å›ºå®šæµç¨‹ï¼šDiff â†’ Context â†’ Review â†’ Verify â†’ Output</li>
      <li>æ¯æ­¥æœ‰æ˜ç¡®è¾“å…¥è¾“å‡ºï¼Œå¯å¹¶è¡Œæ‰§è¡Œ</li>
      <li>å»¶è¿Ÿå¯é¢„æµ‹ï¼Œæˆæœ¬å¯æ§</li>
      <li>é€‚ç”¨äº 95% çš„å¸¸è§„ PR</li>
    </ul>
    
    <p><strong>Agentic æ¨¡å¼ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰ï¼š</strong></p>
    <ul>
      <li>Agent æœ‰è‡ªä¸»æ¢ç´¢èƒ½åŠ›ï¼šçœ‹åˆ°å¯ç–‘ä»£ç  â†’ ä¸»åŠ¨æŸ¥çœ‹ç›¸å…³æ–‡ä»¶ â†’ è¿½æº¯ git blame â†’ å½¢æˆå®Œæ•´åˆ¤æ–­</li>
      <li>é€‚ç”¨äºå¤æ‚é‡æ„ã€è·¨æ¨¡å—å˜æ›´</li>
      <li>å»¶è¿Ÿä¸å¯é¢„æµ‹ï¼Œæˆæœ¬æ›´é«˜</li>
      <li>é€‚ç”¨äº 5% çš„å¤æ‚ PR</li>
    </ul>

    <p><strong>æœ€ä½³å®è·µï¼š</strong>å…ˆç”¨ Pipeline åšåŸºç¡€ reviewï¼Œç”¨å¯å‘å¼è§„åˆ™æ£€æµ‹å¤æ‚ PRï¼Œå¯¹å¤æ‚ PR å¯åŠ¨ Agentic reviewã€‚</p>
  </div>
  <div class="en">
    <p><strong>Key architecture decision: Pipeline vs Agentic?</strong></p>
    <p>This is a high-scoring interview point.</p>
    
    <p><strong>Pipeline (recommended base):</strong></p>
    <ul>
      <li>Fixed flow: Diff â†’ Context â†’ Review â†’ Verify â†’ Output</li>
      <li>Clear I/O per step, parallelizable</li>
      <li>Predictable latency, controllable cost</li>
      <li>Covers 95% of standard PRs</li>
    </ul>
    
    <p><strong>Agentic (advanced):</strong></p>
    <ul>
      <li>Agent autonomously explores: suspicious code â†’ check related files â†’ git blame â†’ form judgment</li>
      <li>For complex refactors, cross-module changes</li>
      <li>Unpredictable latency, higher cost</li>
      <li>For ~5% complex PRs</li>
    </ul>

    <p><strong>Best practice:</strong> Pipeline for base review + heuristic-triggered Agentic for complex PRs.</p>
  </div>
</div>

<pre><code>// Review Engine â€” file-level review pipeline
interface ReviewPipeline {
  // Step 1: Per-file review (parallelized across files)
  reviewFile(context: FileReviewContext): FileReview;
  
  // Step 2: Cross-file analysis (sequential, needs all file reviews)
  crossFileAnalysis(fileReviews: FileReview[]): CrossFileInsight[];
  
  // Step 3: PR-level summary
  summarizePR(fileReviews: FileReview[], crossInsights: CrossFileInsight[]): PRSummary;
  
  // Step 4: Verification pass (reduce false positives)
  verify(comments: ReviewComment[]): ReviewComment[];
}

interface FileReviewContext {
  filePath: string;
  diff: SemanticDiff;           // Difftastic output
  fullFile: string;              // Complete file content
  ast: ASTNode;                  // Tree-sitter AST
  relatedFiles: RelatedFile[];   // Imports, type defs
  historicalPRs: PRSummary[];    // Past changes to this file
  teamRules: Rule[];             // Custom instructions
}

// Complexity detector â€” triggers agentic review
function isComplexPR(pr: PRMetadata): boolean {
  return (
    pr.filesChanged > 30 ||
    pr.hasSchemaChanges ||
    pr.touchesMultipleServices ||
    pr.deletedLines > 500 ||
    pr.labels.includes('refactor')
  );
}</code></pre>

<h3>ç»„ä»¶ 4: Verification Agent â€” é™ä½è¯¯æŠ¥ç‡</h3>

<div class="highlight">
  <h4>âš ï¸ AI Code Review æœ€å¤§æŒ‘æˆ˜ï¼šFalse Positives</h4>
  <p>å¦‚æœ 10 æ¡è¯„è®ºé‡Œ 7 æ¡æ˜¯å™ªéŸ³ï¼Œå¼€å‘è€…ä¼šåœæ­¢çœ‹ä½ çš„è¯„è®ºã€‚<strong>ç²¾å‡†åº¦ > å¬å›ç‡</strong>ã€‚å®å¯æ¼æ‰ä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿä¸è¦ç»™é”™è¯¯å»ºè®®ã€‚</p>
</div>

<div class="bilingual">
  <div class="zh">
    <p><strong>ä¸‰å±‚éªŒè¯æœºåˆ¶ï¼š</strong></p>
    <ol>
      <li><strong>Static Analysis äº¤å‰éªŒè¯</strong>ï¼šReview è¯´ "è¿™é‡Œæœ‰ç±»å‹é”™è¯¯" â†’ è·‘ TypeScript compiler ç¡®è®¤</li>
      <li><strong>LLM Self-Verification</strong>ï¼šç”¨ä¸åŒ prompt è®©æ¨¡å‹æŒ‘æˆ˜è‡ªå·±çš„ç»“è®ºï¼ˆ"ç»™å‡ºè¿™æ¡è¯„è®ºå¯èƒ½é”™è¯¯çš„ç†ç”±"ï¼‰</li>
      <li><strong>Confidence Scoring</strong>ï¼šæ¯æ¡è¯„è®ºé™„å¸¦ç½®ä¿¡åº¦ï¼Œä½äºé˜ˆå€¼çš„è‡ªåŠ¨è¿‡æ»¤æˆ–é™çº§æ˜¾ç¤º</li>
    </ol>
    <p><strong>æ•ˆæœï¼š</strong>éªŒè¯å±‚é€šå¸¸è¿‡æ»¤æ‰ 30-40% çš„åˆå§‹è¯„è®ºï¼Œå¤§å¹…æå‡ç”¨æˆ·ä¿¡ä»»åº¦ã€‚</p>
  </div>
  <div class="en">
    <p><strong>Three-tier verification:</strong></p>
    <ol>
      <li><strong>Static analysis cross-check</strong>: "Type error here" â†’ run TypeScript compiler to confirm</li>
      <li><strong>LLM self-verification</strong>: Challenge its own conclusions with adversarial prompt</li>
      <li><strong>Confidence scoring</strong>: Each comment gets a confidence score; below threshold = filter/downgrade</li>
    </ol>
    <p><strong>Impact:</strong> Verification typically filters 30-40% of initial comments, dramatically improving user trust.</p>
  </div>
</div>

<pre><code>// Verification Agent
async function verifyComment(comment: ReviewComment, context: FileReviewContext): Promise&lt;VerifiedComment | null&gt; {
  // Layer 1: Static analysis check
  if (comment.category === 'type-error') {
    const compilerResult = await runTypeCheck(context.fullFile);
    if (!compilerResult.hasError(comment.line)) {
      return null; // False positive â€” compiler disagrees
    }
  }

  // Layer 2: LLM self-challenge
  const challenge = await llm.complete({
    system: "You are a skeptical reviewer. Find reasons why this review comment might be WRONG.",
    user: `Comment: "${comment.text}"\nCode: ${comment.codeSnippet}\nContext: ${context.summary}`
  });

  // Layer 3: Confidence scoring
  const confidence = await scoreConfidence(comment, challenge);
  
  if (confidence < 0.6) return null;         // Filter out
  if (confidence < 0.8) comment.severity = 'nitpick';  // Downgrade
  
  return { ...comment, confidence, challengeReason: challenge };
}</code></pre>

<h3>ç»„ä»¶ 5: Knowledge Graph & Vector Store</h3>

<div class="bilingual">
  <div class="zh">
    <p><strong>ä¸ºä»€ä¹ˆéœ€è¦å‘é‡æ•°æ®åº“ï¼Ÿ</strong></p>
    <p>æ¯æ¬¡ review éƒ½éœ€è¦æ‰¾åˆ°"ç›¸å…³çš„å†å²ä¸Šä¸‹æ–‡"ã€‚è¿™ä¸æ˜¯ç²¾ç¡®åŒ¹é…ï¼Œè€Œæ˜¯è¯­ä¹‰æœç´¢ï¼š</p>
    <ul>
      <li>"ä¹‹å‰æœ‰äººæ”¹è¿‡ç±»ä¼¼çš„è®¤è¯é€»è¾‘å—ï¼Ÿä»–ä»¬çŠ¯äº†ä»€ä¹ˆé”™ï¼Ÿ"</li>
      <li>"è¿™ä¸ªæ¨¡å¼åœ¨ codebase é‡Œå…¶ä»–åœ°æ–¹æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ"</li>
      <li>"ä¸Šæ¬¡ç¢°åˆ°ç±»ä¼¼çš„æ€§èƒ½é—®é¢˜ï¼Œreviewer å»ºè®®äº†ä»€ä¹ˆï¼Ÿ"</li>
    </ul>
    
    <p><strong>æ•°æ®æºï¼ˆCodeRabbit æ–¹æ¡ˆï¼‰ï¼š</strong></p>
    <ul>
      <li>æ¯ä¸ª repo ä¸€ç»„ vector tablesï¼ˆä¸æ˜¯å…¨å±€å…±äº«ï¼‰</li>
      <li>ç´¢å¼•å†…å®¹ï¼šPR æ‘˜è¦ã€review è¯„è®ºã€commit messagesã€issue descriptions</li>
      <li>Code chunks ç”¨ Tree-sitter åšè¯­ä¹‰åˆ†å—ï¼ˆæŒ‰å‡½æ•°/ç±»ï¼Œä¸æ˜¯æŒ‰è¡Œæ•°ï¼‰</li>
      <li>å®æ—¶æ›´æ–°ï¼šæ¯ä¸ªæ–° PR merge åç«‹å³ç´¢å¼•</li>
    </ul>

    <p><strong>CodeRabbit ç”¨ LanceDB çš„åŸå› ï¼š</strong></p>
    <ul>
      <li>æ¯ä¸ª repo æ˜¯ç‹¬ç«‹çš„ table â†’ æ•°æ®éš”ç¦» + æ”¯æŒ on-prem</li>
      <li>æ¯å¤©å¤„ç†ç™¾ä¸‡çº§å‘é‡æŸ¥è¯¢ï¼Œéœ€è¦ä½å»¶è¿Ÿ</li>
      <li>æ”¯æŒ multimodalï¼ˆä»£ç  + æ–‡æœ¬æ··åˆç´¢å¼•ï¼‰</li>
    </ul>
  </div>
  <div class="en">
    <p><strong>Why vector DB?</strong></p>
    <p>Each review needs "relevant historical context" â€” semantic search, not exact match:</p>
    <ul>
      <li>"Has someone modified similar auth logic before? What mistakes?"</li>
      <li>"How is this pattern implemented elsewhere in the codebase?"</li>
      <li>"What did reviewers suggest for similar perf issues?"</li>
    </ul>
    
    <p><strong>Data sources (CodeRabbit approach):</strong></p>
    <ul>
      <li>Per-repo vector tables (not globally shared)</li>
      <li>Indexed: PR summaries, review comments, commits, issues</li>
      <li>Code chunks via Tree-sitter (by function/class, not line count)</li>
      <li>Real-time: index immediately after each PR merge</li>
    </ul>
  </div>
</div>

<h2>ğŸ“Š å®¹é‡ä¼°ç®— / Capacity Estimation</h2>

<table>
  <tr><th>æŒ‡æ ‡</th><th>æ•°å€¼</th><th>æ¨å¯¼</th></tr>
  <tr><td>Daily PRs</td><td class="metric">100K</td><td>Given</td></tr>
  <tr><td>Avg files/PR</td><td>15</td><td>Given</td></tr>
  <tr><td>Total file reviews/day</td><td>1.5M</td><td>100K Ã— 15</td></tr>
  <tr><td>Avg tokens per file review</td><td>~8K input + ~1K output</td><td>Context + diff + response</td></tr>
  <tr><td>Total tokens/day</td><td>~13.5B input + ~1.5B output</td><td>1.5M Ã— (8K + 1K)</td></tr>
  <tr><td>LLM cost/day (GPT-4o-mini)</td><td>~$2,700</td><td>$0.15/1M in + $0.6/1M out</td></tr>
  <tr><td>LLM cost/day (Claude Sonnet)</td><td>~$13,500</td><td>$3/1M in + $15/1M out (more accurate)</td></tr>
  <tr><td>PR summary tokens</td><td>~20K in + ~2K out per PR</td><td>Aggregation of file reviews</td></tr>
  <tr><td>Verification pass</td><td>+30% token overhead</td><td>Self-challenge on flagged comments</td></tr>
  <tr><td>Vector DB queries/day</td><td>~3M</td><td>~2 queries/file Ã— 1.5M files</td></tr>
  <tr><td>Latency budget</td><td>&lt;3 min p95</td><td>Files reviewed in parallel</td></tr>
  <tr><td>Peak QPS (webhook)</td><td>~5 PRs/sec</td><td>100K/day, peak 4x average</td></tr>
</table>

<div class="highlight-green">
  <h4>ğŸ’° æˆæœ¬ä¼˜åŒ–ç­–ç•¥</h4>
  <p><strong>Model Routing</strong>ï¼šç®€å•æ–‡ä»¶ï¼ˆconfig, docs, testsï¼‰â†’ GPT-4o-mini ($0.15/1M); æ ¸å¿ƒé€»è¾‘æ–‡ä»¶ â†’ Claude Sonnet ($3/1M)</p>
  <p><strong>Diff-based Token Saving</strong>ï¼šDifftastic è¿‡æ»¤æ ¼å¼å™ªéŸ³ï¼ŒèŠ‚çœ 40-60% tokens</p>
  <p><strong>Semantic Cache</strong>ï¼šç›¸åŒ pattern çš„å˜æ›´ï¼ˆå¦‚ "add try-catch"ï¼‰ç¼“å­˜ review template</p>
  <p><strong>æ··åˆæ¨¡å‹åï¼Œä¼°è®¡æ—¥å‡æˆæœ¬ï¼š~$4,000-6,000</strong>ï¼ˆ70% mini + 30% Sonnetï¼‰</p>
</div>

<h2>ğŸ”‘ è®¾è®¡äº®ç‚¹æ€»ç»“ / Key Design Decisions</h2>

<div class="highlight-blue">
  <h4>äº®ç‚¹ 1: Context Engineering > Prompt Engineering</h4>
  <p>ä¸å…¶èŠ±æ—¶é—´è°ƒ promptï¼Œä¸å¦‚æŠ•èµ„åœ¨ç»™ LLM æ›´å¥½çš„ä¸Šä¸‹æ–‡ã€‚ä¸‰å±‚ä¸Šä¸‹æ–‡æ¨¡å‹ï¼ˆCode â†’ Project â†’ Teamï¼‰æ˜¯æ ¸å¿ƒç«äº‰åŠ›ã€‚</p>
</div>

<div class="highlight-blue">
  <h4>äº®ç‚¹ 2: ä¸‰å±‚ Diffï¼ˆText â†’ Syntax â†’ Semanticï¼‰</h4>
  <p>ç”¨ Difftastic + Tree-sitter æ›¿ä»£åŸå§‹ git diffï¼Œä¸ä»…èŠ‚çœ tokenï¼Œè¿˜è®© LLM èƒ½ç†è§£ä»£ç çš„ç»“æ„æ€§å˜åŒ–è€Œéæ–‡æœ¬å˜åŒ–ã€‚</p>
</div>

<div class="highlight-blue">
  <h4>äº®ç‚¹ 3: Pipeline + Agentic æ··åˆæ¶æ„</h4>
  <p>95% ç”¨ç¡®å®šæ€§ Pipelineï¼ˆå¯é¢„æµ‹ã€ä¾¿å®œï¼‰ï¼Œ5% å¤æ‚ PR ç”¨ Agenticï¼ˆçµæ´»ã€æ·±å…¥ï¼‰ã€‚è¿™æ˜¯æˆæœ¬å’Œè´¨é‡çš„æœ€ä¼˜æƒè¡¡ã€‚</p>
</div>

<div class="highlight-blue">
  <h4>äº®ç‚¹ 4: Verification Agentï¼ˆç²¾å‡†åº¦ä¼˜å…ˆï¼‰</h4>
  <p>Static Analysis äº¤å‰éªŒè¯ + LLM è‡ªæˆ‘æŒ‘æˆ˜ + ç½®ä¿¡åº¦è¯„åˆ†ã€‚å®å¯å°‘è¯´ï¼Œä¸å¯è¯´é”™ â€” è¿™æ˜¯ AI review è·å¾—ç”¨æˆ·ä¿¡ä»»çš„å…³é”®ã€‚</p>
</div>

<div class="highlight-blue">
  <h4>äº®ç‚¹ 5: åé¦ˆé—­ç¯ï¼ˆLearning Loopï¼‰</h4>
  <p>ç”¨æˆ·çš„ thumbs up/downã€resolve/dismiss è¡Œä¸ºè‡ªåŠ¨åå“ºåˆ°å›¢é˜ŸçŸ¥è¯†åº“ã€‚ç³»ç»Ÿè¶Šç”¨è¶Šæ‡‚ä½ çš„å›¢é˜Ÿï¼Œå½¢æˆç½‘ç»œæ•ˆåº”ã€‚</p>
</div>

<h2>ğŸ¤ é¢è¯•é«˜é¢‘é—®é¢˜ / Interview Questions</h2>

<div class="interview">
  <h4>Q1: å¦‚ä½•å¤„ç†è¶…å¤§ PRï¼ˆ100+ æ–‡ä»¶ï¼‰ï¼Ÿ</h4>
  <p><strong>ç­”ï¼š</strong>åˆ†å±‚å¤„ç†ã€‚â‘  å…ˆç”¨ AST åšå˜æ›´åˆ†ç±»ï¼ˆé‡æ„ã€æ–°åŠŸèƒ½ã€bugfixã€testï¼‰â†’ æŒ‰ä¼˜å…ˆçº§æ’åºã€‚â‘¡ æ–‡ä»¶çº§ review å®Œå…¨å¹¶è¡ŒåŒ–ã€‚â‘¢ è®¾ç½® token budget ä¸Šé™ï¼Œè¶…å‡ºçš„æ–‡ä»¶åªåš summary ä¸åš inline commentã€‚â‘£ å»ºè®®å¼€å‘è€…æ‹†åˆ† PRï¼ˆè¿™æœ¬èº«å°±æ˜¯ä¸€æ¡æœ‰ä»·å€¼çš„ reviewï¼‰ã€‚â‘¤ å¯ä»¥ç”¨ Agent æ¨¡å¼åš progressive review â€”â€” å…ˆ review æ ¸å¿ƒæ–‡ä»¶ï¼Œå†æ ¹æ®å‘ç°å±•å¼€ã€‚</p>
</div>

<div class="interview">
  <h4>Q2: å¦‚ä½•æ”¯æŒå¤šè¯­è¨€ï¼Ÿæ¯ç§è¯­è¨€éœ€è¦ä¸åŒçš„æ¨¡å‹å—ï¼Ÿ</h4>
  <p><strong>ç­”ï¼š</strong>LLM æœ¬èº«æ˜¯å¤šè¯­è¨€çš„ï¼Œä¸éœ€è¦æ¯ç§è¯­è¨€ä¸€ä¸ªæ¨¡å‹ã€‚å…³é”®åœ¨ <strong>parsing å±‚</strong>ï¼šâ‘  Tree-sitter æ”¯æŒ 200+ è¯­è¨€çš„ AST è§£æã€‚â‘¡ Difftastic ä¹Ÿæ”¯æŒå¤šè¯­è¨€è¯­æ³• diffã€‚â‘¢ è¯­è¨€ç‰¹å®šçš„è§„åˆ™ï¼ˆå¦‚ Go çš„ error handling æƒ¯ä¾‹ã€Rust çš„ ownership æ¨¡å¼ï¼‰é€šè¿‡ <strong>Custom Instructions + Few-shot Examples</strong> æ³¨å…¥ï¼Œä¸éœ€è¦è®­ç»ƒæ–°æ¨¡å‹ã€‚â‘£ å¯ä»¥ä¸ºä¸åŒè¯­è¨€è°ƒæ•´ review prompt çš„å…³æ³¨ç‚¹ã€‚</p>
</div>

<div class="interview">
  <h4>Q3: å¦‚ä½•å‡å°‘ false positivesï¼Ÿç”¨æˆ·ä¸ä¿¡ä»»æ€ä¹ˆåŠï¼Ÿ</h4>
  <p><strong>ç­”ï¼š</strong>è¿™æ˜¯ AI review æœ€å…³é”®çš„æŒ‘æˆ˜ã€‚â‘  <strong>Verification Agent</strong>ï¼šæ¯æ¡è¯„è®ºç»è¿‡ static analysis äº¤å‰éªŒè¯ + LLM è‡ªæˆ‘æŒ‘æˆ˜ã€‚â‘¡ <strong>Confidence scoring</strong>ï¼šä½ç½®ä¿¡åº¦è¯„è®ºè‡ªåŠ¨é™çº§ä¸º "nitpick" æˆ–ç›´æ¥è¿‡æ»¤ã€‚â‘¢ <strong>æ¸è¿›å¼ä¿¡ä»»</strong>ï¼šæ–°ç”¨æˆ·é»˜è®¤ä¿å®ˆæ¨¡å¼ï¼ˆåªè¯„è®ºé«˜ç½®ä¿¡åº¦é—®é¢˜ï¼‰ï¼Œéšç€æ­£åé¦ˆç§¯ç´¯é€æ­¥æ”¾å¼€ã€‚â‘£ <strong>ç”¨æˆ·åé¦ˆé—­ç¯</strong>ï¼šdismiss çš„è¯„è®ºåå“º team learningsï¼ŒåŒç±»è¯„è®ºä¸å†å‡ºç°ã€‚ç›®æ ‡ï¼šå®å¯ 60% å¬å›ç‡ + 95% ç²¾å‡†ç‡ï¼Œä¹Ÿä¸è¦ 95% å¬å› + 60% ç²¾å‡†ã€‚</p>
</div>

<div class="interview">
  <h4>Q4: å¦‚ä½•ä¿è¯ä½å»¶è¿Ÿï¼ˆ2-5 åˆ†é’Ÿï¼‰ï¼Ÿ</h4>
  <p><strong>ç­”ï¼š</strong>â‘  <strong>å¹¶è¡ŒåŒ–</strong>ï¼šæ–‡ä»¶çº§ review å®Œå…¨å¹¶è¡Œï¼Œ15 ä¸ªæ–‡ä»¶åŒæ—¶é€ LLM â†’ å»¶è¿Ÿå–å†³äºæœ€æ…¢çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œéæ€»å’Œã€‚â‘¡ <strong>é¢„è®¡ç®—</strong>ï¼šrepo çš„ ASTã€dependency graphã€vector index åœ¨ PR ä¹‹å‰å°±å·²ç»å»ºå¥½ï¼ˆå¢é‡æ›´æ–°ï¼‰ã€‚â‘¢ <strong>Model routing</strong>ï¼šç®€å•æ–‡ä»¶ç”¨å¿«æ¨¡å‹ï¼ˆGPT-4o-mini ~1sï¼‰ï¼Œåªæœ‰æ ¸å¿ƒé€»è¾‘æ–‡ä»¶ç”¨æ…¢æ¨¡å‹ï¼ˆSonnet ~5sï¼‰ã€‚â‘£ <strong>Streaming output</strong>ï¼šreview å®Œä¸€ä¸ªæ–‡ä»¶å°±ç«‹å³ post è¯„è®ºï¼Œä¸ç­‰æ‰€æœ‰æ–‡ä»¶å®Œæˆã€‚â‘¤ P95 ç“¶é¢ˆé€šå¸¸åœ¨ context assemblyï¼ˆgit API + vector searchï¼‰ï¼Œç”¨ cache + batch ä¼˜åŒ–ã€‚</p>
</div>

<h2>ğŸ”— ç³»åˆ—æ€»ç»“ / Series Recap</h2>

<div class="highlight-green">
  <h4>ğŸ‰ Phase 2.1 AI System Design é¢è¯•é¢˜ç³»åˆ—å®Œç»“ï¼</h4>
  <p>5 å¤©è¦†ç›–äº† FAANG+ é¢è¯•æœ€é«˜é¢‘çš„ 5 ä¸ª AI System Design é¢˜ç›®ï¼š</p>
  <table>
    <tr><th>Day</th><th>Topic</th><th>æ ¸å¿ƒæ¶æ„æ¨¡å¼</th></tr>
    <tr><td>1</td><td>è®¾è®¡ ChatGPT</td><td>SSE æµå¼è¾“å‡ºã€LLM Gatewayã€Safety Pipeline</td></tr>
    <tr><td>2</td><td>è®¾è®¡æ¨èç³»ç»Ÿ</td><td>å¤šé˜¶æ®µæ¼æ–—ã€Two-Towerã€Feature Store</td></tr>
    <tr><td>3</td><td>è®¾è®¡è¯­ä¹‰æœç´¢</td><td>Bi/Cross-Encoderã€ANN (HNSW)ã€Hybrid Search</td></tr>
    <tr><td>4</td><td>è®¾è®¡ RAG çŸ¥è¯†åº“</td><td>Permission-Aware Retrievalã€Grounded Generation</td></tr>
    <tr><td>5</td><td>è®¾è®¡ AI Code Review</td><td>Context Engineeringã€Pipeline+Agenticã€Verification Agent</td></tr>
  </table>
  <p><strong>é€šç”¨èƒ½åŠ›ï¼š</strong>å®¹é‡ä¼°ç®—ã€æˆæœ¬åˆ†æã€å»¶è¿Ÿä¼˜åŒ–ã€Model Routing â€” æ¯ä¸ªç³»ç»Ÿéƒ½ç”¨åˆ°äº†ï¼</p>
</div>

<h2>ğŸ¤” æ€è€ƒé¢˜ / Think About It</h2>

<div class="bilingual">
  <div class="zh">
    <p>å›é¡¾è¿™ 5 å¤©çš„ç³»ç»Ÿï¼Œå®ƒä»¬å…¶å®å¯ä»¥äº’ç›¸ç»„åˆï¼š</p>
    <ul>
      <li>Code Review ç³»ç»Ÿçš„æ£€ç´¢ç”¨çš„å°±æ˜¯ Day 3 çš„è¯­ä¹‰æœç´¢</li>
      <li>Code Review çš„ä¸Šä¸‹æ–‡ç»„è£…ç”¨çš„å°±æ˜¯ Day 4 çš„ RAG</li>
      <li>Code Review çš„æµå¼è¯„è®ºè¾“å‡ºç”¨çš„å°±æ˜¯ Day 1 çš„ SSE</li>
    </ul>
    <p><strong>é—®é¢˜ï¼šå¦‚æœè¦ä½ è®¾è®¡ä¸€ä¸ª "AI ç¼–ç¨‹åŠ©æ‰‹"ï¼ˆåƒ Cursor/Windsurfï¼‰ï¼Œä½ ä¼šæ€ä¹ˆæŠŠè¿™ 5 ä¸ªç³»ç»Ÿç»„åˆèµ·æ¥ï¼Ÿå®ƒæ¯”ä»»ä½•å•ä¸ªç³»ç»Ÿéš¾åœ¨å“ªé‡Œï¼Ÿ</strong></p>
  </div>
  <div class="en">
    <p>Looking back at all 5 systems, they can compose:</p>
    <ul>
      <li>Code Review's retrieval = Day 3 semantic search</li>
      <li>Code Review's context assembly = Day 4 RAG</li>
      <li>Code Review's streaming comments = Day 1 SSE</li>
    </ul>
    <p><strong>Question: If you were to design an "AI coding assistant" (like Cursor/Windsurf), how would you compose all 5 systems? What makes it harder than any individual system?</strong></p>
  </div>
</div>

<p style="text-align: center; color: #999; margin-top: 40px;">ğŸ“š Knowledge Push by Scholar | 2026-02-14 | AI System Design Day 5/5 âœ…</p>

</body>
</html>
